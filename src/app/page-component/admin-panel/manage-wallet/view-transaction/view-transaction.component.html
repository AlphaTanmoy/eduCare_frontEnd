<div class="card">
  <!-- Card Header -->
  <div class="card-header d-flex justify-content-between align-items-center">
    <h5 class="mb-0">Transaction Details</h5>
    <button type="button" class="btn-close" (click)="dialogRef.close()" aria-label="Close">
      <fa-icon [icon]="faTimes"></fa-icon>
    </button>
  </div>

  <!-- Card Body -->
  <div class="card-body">
    <!-- Basic Transaction Info -->
    <div class="row mb-4">
      <div class="col-md-6">
        <p class="mb-2"><strong>Reference ID:</strong> {{data.referenceId || 'N/A'}}</p>
        <p class="mb-2">
          <strong>Status:</strong> 
          <span [class]="getStatusClass(data.status)">
            {{data.status || 'N/A'}}
          </span>
        </p>
        <p class="mb-2">
          <strong>Type:</strong> 
          <span [class]="getTransactionTypeClass(data.transactionType)">
            {{data.transactionType || 'N/A'}}
          </span>
        </p>
      </div>
      <div class="col-md-6">
        <p class="mb-2"><strong>Date & Time:</strong> {{formatDate(data.date)}}</p>
        <p class="mb-2"><strong>Created At:</strong> {{formatDate(data.createdAt)}}</p>
        <p class="mb-2"><strong>Updated At:</strong> {{formatDate(data.updatedAt)}}</p>
      </div>
    </div>

    <!-- Amount Details -->
    <div class="border-top pt-3 mb-4">
      <h6 class="mb-3">Amount Details</h6>
      <div class="row">
        <div class="col-md-4">
          <p class="mb-2"><strong>Amount:</strong> 
            <span [class]="(data.changedAmount ?? 0) >= 0 ? 'text-success' : 'text-danger'">
              {{(data.changedAmount ?? 0) >= 0 ? '+' : ''}}{{formatCurrency(data.changedAmount ?? 0)}}
            </span>
          </p>
        </div>
        <div class="col-md-4">
          <p class="mb-2"><strong>Balance:</strong> {{formatCurrency(data.currentAmount ?? 0)}}</p>
        </div>
        <div class="col-md-4">
          <p class="mb-2"><strong>Effected Value:</strong> {{data.effectedValue || 'N/A'}}</p>
        </div>
      </div>
    </div>

    <!-- Additional Info -->
    <div class="border-top pt-3 mb-4">
      <h6 class="mb-3">Additional Information</h6>
      <p class="mb-2"><strong>Franchise ID:</strong> {{data.franchiseId || 'N/A'}}</p>
      <p class="mb-2"><strong>Wallet ID:</strong> {{data.walletId || 'N/A'}}</p>
      <p class="mb-2"><strong>Created By:</strong> {{data.createdBy || 'N/A'}}</p>
    </div>

    <!-- Notes -->
    <div class="border-top pt-3 mb-3" *ngIf="data.notes">
      <h6 class="mb-2">Notes</h6>
      <p class="mb-0">{{data.notes}}</p>
    </div>

    <!-- Misc Data -->
    <div class="border-top pt-3" *ngIf="data.miscData">
      <h6 class="mb-3">Additional Details</h6>
      <div class="table-responsive">
        <table class="table table-sm table-bordered">
          <tbody>
            <ng-container *ngIf="getMiscData() as miscData">
              <ng-container *ngIf="isObject(miscData)">
                <ng-container *ngFor="let key of getObjectKeys(miscData)">
                  <tr *ngIf="!isObject(miscData[key]) && !isArray(miscData[key])">
                    <td class="fw-bold" style="width: 30%;">{{key}}</td>
                    <td>{{miscData[key] !== null && miscData[key] !== undefined ? miscData[key] : 'N/A'}}</td>
                  </tr>
                  <tr *ngIf="isObject(miscData[key]) || isArray(miscData[key])">
                    <td class="fw-bold" style="width: 30%;">{{key}}</td>
                    <td>
                      <pre class="mb-0">{{miscData[key] | json}}</pre>
                    </td>
                  </tr>
                </ng-container>
              </ng-container>
              <tr *ngIf="!isObject(miscData)">
                <td colspan="2">
                  <pre class="mb-0">{{miscData | json}}</pre>
                </td>
              </tr>
            </ng-container>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Card Footer -->
  <div class="card-footer text-end">
    <button type="button" class="btn btn-primary" (click)="dialogRef.close()">Close</button>
  </div>
</div>
