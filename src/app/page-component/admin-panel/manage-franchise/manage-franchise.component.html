<div class="container-fluid w-100">
  <h2 class="m-4 text-center">Manage Franchises</h2>

  <div class="border p-2 rounded-2">
    <div class="d-flex justify-content-between mb-3">
      <input matInput (keyup)="applyFilter($event)" #input class="form-control w-25" placeholder="Search..." />

      <div class="d-flex">
        <button class="btn btn-primary me-2 btn-sm" [disabled]="!canApproveReject"
          (click)="ApprovOrReject(ApproveRejectOperation.approve)">Approve</button>
        <button class="btn btn-warning btn-sm" [disabled]="!canApproveReject"
          (click)="ApprovOrReject(ApproveRejectOperation.reject)">Reject</button>
      </div>
    </div>

    <div class="w-100 overflow-auto">
      <table mat-table [dataSource]="dataSource"
        class="table table-bordered text-center align-middle rounded-3 overflow-hidden" style="margin: 0;">

        <ng-container matColumnDef="center_name">
          <th mat-header-cell *matHeaderCellDef class="text-center fw-bold fs-6"
            style="background-color: var(--light);"> Name </th>
          <td mat-cell *matCellDef="let franchise" class="text-center"> {{ franchise.center_name }} </td>
        </ng-container>

        <ng-container matColumnDef="center_contact_number">
          <th mat-header-cell *matHeaderCellDef class="text-center fw-bold fs-6"
            style="background-color: var(--light);"> Contact Number
          </th>
          <td mat-cell *matCellDef="let franchise" class="text-center"> {{ franchise.center_contact_number }} </td>
        </ng-container>

        <ng-container matColumnDef="center_email_id">
          <th mat-header-cell *matHeaderCellDef class="text-center fw-bold fs-6"
            style="background-color: var(--light);"> Email ID </th>
          <td mat-cell *matCellDef="let franchise" class="text-center"> {{ franchise.center_email_id }} </td>
        </ng-container>

        <ng-container matColumnDef="center_category">
          <th mat-header-cell *matHeaderCellDef class="text-center fw-bold fs-6"
            style="background-color: var(--light);"> Category </th>
          <td mat-cell *matCellDef="let franchise" class="text-center"> {{ franchise.center_category }} </td>
        </ng-container>

        <ng-container matColumnDef="center_type">
          <th mat-header-cell *matHeaderCellDef class="text-center fw-bold fs-6"
            style="background-color: var(--light);"> Type </th>
          <td mat-cell *matCellDef="let franchise" class="text-center"> {{ franchise.center_type }} </td>
        </ng-container>

        <ng-container matColumnDef="center_address">
          <th mat-header-cell *matHeaderCellDef class="text-center fw-bold fs-6"
            style="background-color: var(--light);"> Address </th>
          <td mat-cell *matCellDef="let franchise" class="text-center"> {{ franchise.center_address }} </td>
        </ng-container>

        <ng-container matColumnDef="data_status">
          <th mat-header-cell *matHeaderCellDef class="text-center fw-bold fs-6"
            style="background-color: var(--light);"> Data Status
          </th>
          <td mat-cell *matCellDef="let franchise" class="text-center"> {{ GetDataStatusLabel(franchise.data_status) }}
          </td>
        </ng-container>

        <ng-container matColumnDef="is_approved">
          <th mat-header-cell *matHeaderCellDef class="text-center fw-bold fs-6"
            style="background-color: var(--light);"> Approval
            Status
          </th>
          <td mat-cell *matCellDef="let franchise" class="text-center">{{ GetApprovalStatusLabel(franchise.is_approved)
            }}
          </td>
        </ng-container>

        <ng-container matColumnDef="approve_or_reject">
          <th mat-header-cell *matHeaderCellDef class="text-center fw-bold fs-6"
            style="background-color: var(--light);"> Approve/Reject
          </th>
          <td mat-cell *matCellDef="let franchise" class="text-center">
            <input type="checkbox" *ngIf="franchise.approval_rejection_status"
              [disabled]="franchise.approval_rejection_status" [checked]="franchise.approval_rejection_status">

            <input type="checkbox" *ngIf="!franchise.approval_rejection_status" [ngModelOptions]="{ standalone: true }"
              [(ngModel)]="franchise.new_approval_reject_status"
              (change)="ApprovalRejectCheckboxChange($event, franchise)">
          </td>
        </ng-container>

        <ng-container matColumnDef="created_at">
          <th mat-header-cell *matHeaderCellDef class="text-center fw-bold fs-6"
            style="background-color: var(--light);"> Created At
          </th>
          <td mat-cell *matCellDef="let franchise" class="text-center"> {{ FormatDateTime(franchise.created_at) }} </td>
        </ng-container>

        <ng-container matColumnDef="action">
          <th mat-header-cell *matHeaderCellDef class="text-center fw-bold fs-6"
            style="background-color: var(--light);"> Action </th>
          <td mat-cell *matCellDef="let franchise" class="text-center">

            <div class="d-flex w-100 justify-content-around h-100 gap-1">           
              <fa-icon class="icon btn_cursor_pointer" title="View Franchise Center Head Details" [icon]="faCircleInfo"></fa-icon>
              <fa-icon class="icon btn_cursor_pointer" title="View Franchise Documents" [icon]="faEye"></fa-icon>
              <fa-icon class="icon btn_cursor_pointer" title="Edit Franchise Information" [icon]="faEdit"></fa-icon>
              <fa-icon class="icon btn_cursor_pointer" title="Download Franchise Documents"
                [icon]="faDownload"></fa-icon>
            </div>
          </td>

        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns" class="align-middle"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="align-middle"></tr>

        <tr class="mat-row text-center" *matNoDataRow>
          <td class="mat-cell" colspan="100%" *ngIf="totalCount !== 0">No data matching the filter "{{ input.value }}"
          </td>
        </tr>
      </table>
    </div>

    <mat-paginator class="mt-3" [length]="totalCount" [pageSize]="page_size"
      [pageSizeOptions]="[5, 10, 30, 50, 100]"></mat-paginator>
  </div>
</div>